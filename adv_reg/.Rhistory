boxplot(balance ~ student, data = Default)
x = c(410, 500, 471, 619, 584, 681, 399, 481, 624, 589)
y = c(0, 1, 0, 1, 0, 1, 0, 1, 1, 1)
X = cbind(x)
reg_res = mult_reg(X, y, alpha = 0.05, coeff = TRUE)
reg_res$beta_hat
source("functions/mult_reg.R", echo = FALSE)
IRWLS_res = irwls_logistic_reg(X, y)
simp_res = mult_reg(X, y, alpha = 0.05, coeff = TRUE)
MSE = simp_res$MSE
W = IRWLS_res$W
one = c(rep(1, length(x)))
X = cbind(one, x)
## 단순회귀 beta_hat 분산
var_beta_hat_LSE = MSE * solve(t(X) %*% X)
## IRWLS beta_hat 분산
var_beta_hat_IRWLS = solve(t(X) %*% W %*% X)
var_beta_hat_LSE ; var_beta_hat_IRWLS
beta_hat_IRWLS = IRWLS_res$beta_hat
score = t(c(1, 550)) %*% beta_hat_IRWLS
p_hat_y_1_x_500 = exp(score) / (1 + exp(score))
p_hat_y_1_x_500
library(ISLR)
library(dplyr)
dataset_default = Default %>% na.omit()
X = dataset_default %>%
dplyr::select(balance:income)
y = ifelse(dataset_default$default == "Yes", 1, 0)
X = as.matrix(X)
default_irwls_res = irwls_logistic_reg(X, y, tol = 1e-8)
glm_res <- glm(default ~ balance + income, data = Default, family = binomial)
glm_res$coefficients
knitr::opts_chunk$set(echo = TRUE)
source("functions/mult_reg.R", echo = F)
source("functions/reg_diagnostics.R", echo = F)
source("functions/var_selection.R", echo = F)
source("functions/anova_reg.R", echo = F)
library(ISLR)
plot(income ~ balance, col = ifelse(default == "No", "grey", "black"), cex = 0.1, data = Default)
legend("topright",
legend = c("default = no", "default = yes"),
col    = c("grey", "black"),
lty    = 1,
cex    = 1.2,
bg     = "white")
boxplot(balance ~ default, data = Default)
boxplot(income ~ default, data = Default)
glm.fit <- glm(default ~ balance, data = Default, family = binomial)
summary(glm.fit)
glm_coef = glm.fit$coefficients
curve(expr = exp(glm_coef[1] + glm_coef[2] * x) / (1 + exp(glm_coef[1] + glm_coef[2] * x)), from = 100, to = 10000, n = 101, xlab = "balance", ylab = "default Prob")
glm.fit <- glm(default ~ student, data = Default, family = binomial)
summary(glm.fit)
mglm.fit <- glm(default ~ balance + income + student, data = Default, family = binomial)
summary(mglm.fit)
yes.dat <- data.frame(balance = 0:2655, income = mean(Default$income), student = "Yes")
no.dat <- data.frame(balance = 0:2655, income = mean(Default$income), student = "No")
yes.prob <- predict(mglm.fit, yes.dat, type = "response")
no.prob <- predict(mglm.fit, no.dat, type = "response")
x =c(0 : 2655)
plot(x = x, y = yes.prob, col = "lightblue", lwd = 1.0,
xlab  = "Balance", ylab = "P(default = yes)")
# 2) 두 번째 곡선 추가
lines(x, no.prob, col = "blue", lwd = 1.0)
legend("topleft",
legend = c("Student = Yes", "Student = No"),
col    = c("lightblue", "blue"),
lty    = 1,
lwd    = 2.5,
cex    = 1.2,
bg     = "white")
yes.dat2 <- data.frame(balance = mean(Default$balance),
income = mean(Default$income), student = "Yes")
no.dat2 <- data.frame(balance = mean(Default$balance),
income = mean(Default$income), student = "No")
yes2.prob <- predict(mglm.fit, yes.dat2, type = "response")
no2.prob <- predict(mglm.fit, no.dat2, type = "response")
yes2.prob ; no2.prob
boxplot(balance ~ student, data = Default)
x = c(410, 500, 471, 619, 584, 681, 399, 481, 624, 589)
y = c(0, 1, 0, 1, 0, 1, 0, 1, 1, 1)
X = cbind(x)
reg_res = mult_reg(X, y, alpha = 0.05, coeff = TRUE)
reg_res$beta_hat
source("functions/mult_reg.R", echo = FALSE)
IRWLS_res = irwls_logistic_reg(X, y)
simp_res = mult_reg(X, y, alpha = 0.05, coeff = TRUE)
MSE = simp_res$MSE
W = IRWLS_res$W
one = c(rep(1, length(x)))
X = cbind(one, x)
## 단순회귀 beta_hat 분산
var_beta_hat_LSE = MSE * solve(t(X) %*% X)
## IRWLS beta_hat 분산
var_beta_hat_IRWLS = solve(t(X) %*% W %*% X)
var_beta_hat_LSE ; var_beta_hat_IRWLS
beta_hat_IRWLS = IRWLS_res$beta_hat
score = t(c(1, 550)) %*% beta_hat_IRWLS
p_hat_y_1_x_500 = exp(score) / (1 + exp(score))
p_hat_y_1_x_500
library(ISLR)
library(dplyr)
dataset_default = Default %>% na.omit()
X = dataset_default %>%
dplyr::select(balance:income)
y = ifelse(dataset_default$default == "Yes", 1, 0)
X = as.matrix(X)
default_irwls_res = irwls_logistic_reg(X, y, tol = 1e-8)
glm_res <- glm(default ~ balance + income, data = Default, family = binomial)
glm_res$coefficients
summary(glm_res)
anova(glm_res)
x = c(12, 15, 42, 52, 59, 73, 82, 91, 96, 105, 114, 120, 121, 128, 130, 139, 139, 157,
1, 1, 2, 8, 11, 18, 22, 31, 37, 61, 72, 81, 97, 112, 118, 127, 131, 140, 151, 159, 177, 206)
y = c(rep(1, 18), rep(0, 22))
X = cbind(x)
IRWLS_res = irwls_logistic_reg(X, y)
IRWLS_res$beta_hat
X = cbind(x)
IRWLS_res = irwls_logistic_reg(X, y)
GLM_res = glm(y ~ x, family = binomial)
GLM_res$coefficients
x = c(12, 15, 42, 52, 59, 73, 82, 91, 96, 105, 114, 120, 121, 128, 130, 139, 139, 157,
1, 1, 2, 8, 11, 18, 22, 31, 37, 61, 72, 81, 97, 112, 118, 127, 131, 140, 151, 159, 177, 206)
y = c(rep(1, 18), rep(0, 22))
X = cbind(x)
IRWLS_res = irwls_logistic_reg(X, y)
GLM_res = glm(y ~ x, family = binomial)
GLM_res$coefficients
summary(GLM_res)
anova(GLM_res)
summary(GLM_res)
anova(GLM_res)
plot(y ~ x, col = ifelse(y == 1, "lightblue", "blue"), cex = 0.1)
legend("topright",
legend = c("kyphosis = yes", "kyphosis = no"),
col    = c("lightblue", "blue"),
lty    = 1,
cex    = 1.2,
bg     = "white")
op <- par(no.readonly = TRUE)
par(mar = c(5, 4, 4, 8) + 0.1)
plot(y ~ x, col = ifelse(y == 1, "lightblue", "blue"), cex = 0.6)
par(xpd = NA)
legend("topright",
legend = c("kyphosis = yes", "kyphosis = no"),
inset  = c(-0.25, 0),
col    = c("lightblue", "blue"),
lty    = 1,
cex    = 1.2,
bg     = "white")
par(op)
op <- par(no.readonly = TRUE)
par(mar = c(5, 4, 4, 8) + 0.1)
plot(y ~ x, col = ifelse(y == 1, "lightblue", "blue"), cex = 0.6)
par(xpd = NA)
legend("topright",
legend = c("kyphosis = yes", "kyphosis = no"),
inset  = c(-0.4, 0),
col    = c("lightblue", "blue"),
lty    = 1,
cex    = 1.2,
bg     = "white")
par(op)
op <- par(no.readonly = TRUE)
par(mar = c(5, 4, 4, 8) + 0.1)
plot(y ~ x, col = ifelse(y == 1, "lightblue", "blue"), cex = 0.6)
par(xpd = NA)
legend("topright",
legend = c("kyphosis = yes", "kyphosis = no"),
inset  = c(-0.4, 0),
col    = c("lightblue", "blue"),
lty    = 1,
cex    = 0.6,
bg     = "white")
par(op)
op <- par(no.readonly = TRUE)
par(mar = c(5, 4, 4, 8) + 0.1)
plot(y ~ x, col = ifelse(y == 1, "lightblue", "blue"), cex = 0.6)
par(xpd = NA)
legend("topright",
legend = c("kyphosis = yes", "kyphosis = no"),
inset  = c(-0.2, 0),
col    = c("lightblue", "blue"),
lty    = 1,
cex    = 0.6,
bg     = "white")
par(op)
op <- par(no.readonly = TRUE)
par(mar = c(5, 4, 4, 8) + 0.1)
plot(y ~ x, col = ifelse(y == 1, "lightblue", "blue"), cex = 0.6)
par(xpd = NA)
legend("topright",
legend = c("kyphosis = yes", "kyphosis = no"),
inset  = c(-0.25, 0),
col    = c("lightblue", "blue"),
lty    = 1,
cex    = 0.6,
bg     = "white")
par(op)
op <- par(no.readonly = TRUE)
par(mar = c(5, 4, 4, 8) + 0.1)
plot(y ~ x, col = ifelse(y == 1, "lightblue", "blue"), cex = 0.85)
par(xpd = NA)
legend("topright",
legend = c("kyphosis = yes", "kyphosis = no"),
inset  = c(-0.25, 0),
col    = c("lightblue", "blue"),
lty    = 1,
cex    = 0.6,
bg     = "white")
par(op)
op <- par(no.readonly = TRUE)
par(mar = c(5, 4, 4, 8) + 0.1)
plot(x ~ y, col = ifelse(y == 1, "lightblue", "blue"), cex = 0.85)
par(xpd = NA)
legend("topright",
legend = c("kyphosis = yes", "kyphosis = no"),
inset  = c(-0.25, 0),
col    = c("lightblue", "blue"),
lty    = 1,
cex    = 0.6,
bg     = "white")
par(op)
knitr::opts_chunk$set(echo = TRUE)
source("functions/mult_reg.R", echo = F)
source("functions/reg_diagnostics.R", echo = F)
source("functions/var_selection.R", echo = F)
source("functions/anova_reg.R", echo = F)
library(ISLR)
plot(income ~ balance, col = ifelse(default == "No", "grey", "black"), cex = 0.1, data = Default)
legend("topright",
legend = c("default = no", "default = yes"),
col    = c("grey", "black"),
lty    = 1,
cex    = 1.2,
bg     = "white")
boxplot(balance ~ default, data = Default)
boxplot(income ~ default, data = Default)
glm.fit <- glm(default ~ balance, data = Default, family = binomial)
summary(glm.fit)
glm_coef = glm.fit$coefficients
curve(expr = exp(glm_coef[1] + glm_coef[2] * x) / (1 + exp(glm_coef[1] + glm_coef[2] * x)), from = 100, to = 10000, n = 101, xlab = "balance", ylab = "default Prob")
glm.fit <- glm(default ~ student, data = Default, family = binomial)
summary(glm.fit)
mglm.fit <- glm(default ~ balance + income + student, data = Default, family = binomial)
summary(mglm.fit)
yes.dat <- data.frame(balance = 0:2655, income = mean(Default$income), student = "Yes")
no.dat <- data.frame(balance = 0:2655, income = mean(Default$income), student = "No")
yes.prob <- predict(mglm.fit, yes.dat, type = "response")
no.prob <- predict(mglm.fit, no.dat, type = "response")
x =c(0 : 2655)
plot(x = x, y = yes.prob, col = "lightblue", lwd = 1.0,
xlab  = "Balance", ylab = "P(default = yes)")
# 2) 두 번째 곡선 추가
lines(x, no.prob, col = "blue", lwd = 1.0)
legend("topleft",
legend = c("Student = Yes", "Student = No"),
col    = c("lightblue", "blue"),
lty    = 1,
lwd    = 2.5,
cex    = 1.2,
bg     = "white")
yes.dat2 <- data.frame(balance = mean(Default$balance),
income = mean(Default$income), student = "Yes")
no.dat2 <- data.frame(balance = mean(Default$balance),
income = mean(Default$income), student = "No")
yes2.prob <- predict(mglm.fit, yes.dat2, type = "response")
no2.prob <- predict(mglm.fit, no.dat2, type = "response")
yes2.prob ; no2.prob
boxplot(balance ~ student, data = Default)
x = c(410, 500, 471, 619, 584, 681, 399, 481, 624, 589)
y = c(0, 1, 0, 1, 0, 1, 0, 1, 1, 1)
X = cbind(x)
reg_res = mult_reg(X, y, alpha = 0.05, coeff = TRUE)
reg_res$beta_hat
source("functions/mult_reg.R", echo = FALSE)
IRWLS_res = irwls_logistic_reg(X, y)
simp_res = mult_reg(X, y, alpha = 0.05, coeff = TRUE)
MSE = simp_res$MSE
W = IRWLS_res$W
one = c(rep(1, length(x)))
X = cbind(one, x)
## 단순회귀 beta_hat 분산
var_beta_hat_LSE = MSE * solve(t(X) %*% X)
## IRWLS beta_hat 분산
var_beta_hat_IRWLS = solve(t(X) %*% W %*% X)
var_beta_hat_LSE ; var_beta_hat_IRWLS
beta_hat_IRWLS = IRWLS_res$beta_hat
score = t(c(1, 550)) %*% beta_hat_IRWLS
p_hat_y_1_x_500 = exp(score) / (1 + exp(score))
p_hat_y_1_x_500
library(ISLR)
library(dplyr)
dataset_default = Default %>% na.omit()
X = dataset_default %>%
dplyr::select(balance:income)
y = ifelse(dataset_default$default == "Yes", 1, 0)
X = as.matrix(X)
default_irwls_res = irwls_logistic_reg(X, y, tol = 1e-8)
glm_res <- glm(default ~ balance + income, data = Default, family = binomial)
glm_res$coefficients
summary(glm_res)
anova(glm_res)
x = c(12, 15, 42, 52, 59, 73, 82, 91, 96, 105, 114, 120, 121, 128, 130, 139, 139, 157,
1, 1, 2, 8, 11, 18, 22, 31, 37, 61, 72, 81, 97, 112, 118, 127, 131, 140, 151, 159, 177, 206)
y = c(rep(1, 18), rep(0, 22))
X = cbind(x)
IRWLS_res = irwls_logistic_reg(X, y)
GLM_res = glm(y ~ x, family = binomial)
GLM_res$coefficients
summary(GLM_res)
anova(GLM_res)
op <- par(no.readonly = TRUE)
par(mar = c(5, 4, 4, 8) + 0.1)
plot(y ~ x, col = ifelse(y == 1, "lightblue", "blue"), cex = 0.85)
par(xpd = NA)
legend("topright",
legend = c("kyphosis = yes", "kyphosis = no"),
inset  = c(-0.25, 0),
col    = c("lightblue", "blue"),
lty    = 1,
cex    = 0.6,
bg     = "white")
par(op)
op <- par(no.readonly = TRUE)
par(mar = c(5, 4, 4, 8) + 0.1)
plot(x ~ y, col = ifelse(y == 1, "lightblue", "blue"), cex = 0.85)
par(xpd = NA)
legend("topright",
legend = c("kyphosis = yes", "kyphosis = no"),
inset  = c(-0.25, 0),
col    = c("lightblue", "blue"),
lty    = 1,
cex    = 0.6,
bg     = "white")
par(op)
X = cbind(x, x^2)
colnames(X) = c("age", "age^2")
IRWLS_res = irwls_logistic_reg(X, y)
GLM_res = glm(y ~ X, family = binomial)
GLM_res$coefficients
summary(GLM_res)
anova(GLM_res)
kyphosis_yes_prob = predict(GLM_res, X, type = "response")
X_df = data.frame(X)
kyphosis_yes_prob = predict(GLM_res, X_df, type = "response")
plot(x = x, y = kyphosis_yes_prob, xlab = "age", ylab = "P(kyphosis = yes | age)",
lwd = 1.0, col = "lightblue")
X_df = data.frame(X)
kyphosis_yes_prob = predict(GLM_res, X_df, type = "response")
plot(x = x, y = kyphosis_yes_prob, xlab = "age", ylab = "P(kyphosis = yes | age)",
lwd = 1.0, col = "lightblue", cex = 0.8)
X_df = data.frame(X)
kyphosis_yes_prob = predict(GLM_res, X_df, type = "response")
plot(x = x, y = kyphosis_yes_prob, xlab = "age", ylab = "P(kyphosis = yes | age)",
lwd = 1.0, col = "lightblue", cex = 0.8, pch = 21)
X_df = data.frame(X)
kyphosis_yes_prob = predict(GLM_res, X_df, type = "response")
plot(x = x, y = kyphosis_yes_prob, xlab = "age", ylab = "P(kyphosis = yes | age)",
lwd = 1.0, col = "lightblue", cex = 0.8, pch = 21, bg  = "lightblue")
knitr::opts_chunk$set(echo = TRUE)
source("functions/mult_reg.R", echo = F)
source("functions/reg_diagnostics.R", echo = F)
source("functions/var_selection.R", echo = F)
source("functions/anova_reg.R", echo = F)
library(ISLR)
plot(income ~ balance, col = ifelse(default == "No", "grey", "black"), cex = 0.1, data = Default)
legend("topright",
legend = c("default = no", "default = yes"),
col    = c("grey", "black"),
lty    = 1,
cex    = 1.2,
bg     = "white")
boxplot(balance ~ default, data = Default)
boxplot(income ~ default, data = Default)
glm.fit <- glm(default ~ balance, data = Default, family = binomial)
summary(glm.fit)
glm_coef = glm.fit$coefficients
curve(expr = exp(glm_coef[1] + glm_coef[2] * x) / (1 + exp(glm_coef[1] + glm_coef[2] * x)), from = 100, to = 10000, n = 101, xlab = "balance", ylab = "default Prob")
glm.fit <- glm(default ~ student, data = Default, family = binomial)
summary(glm.fit)
mglm.fit <- glm(default ~ balance + income + student, data = Default, family = binomial)
summary(mglm.fit)
yes.dat <- data.frame(balance = 0:2655, income = mean(Default$income), student = "Yes")
no.dat <- data.frame(balance = 0:2655, income = mean(Default$income), student = "No")
yes.prob <- predict(mglm.fit, yes.dat, type = "response")
no.prob <- predict(mglm.fit, no.dat, type = "response")
x =c(0 : 2655)
plot(x = x, y = yes.prob, col = "lightblue", lwd = 1.0,
xlab  = "Balance", ylab = "P(default = yes)")
# 2) 두 번째 곡선 추가
lines(x, no.prob, col = "blue", lwd = 1.0)
legend("topleft",
legend = c("Student = Yes", "Student = No"),
col    = c("lightblue", "blue"),
lty    = 1,
lwd    = 2.5,
cex    = 1.2,
bg     = "white")
yes.dat2 <- data.frame(balance = mean(Default$balance),
income = mean(Default$income), student = "Yes")
no.dat2 <- data.frame(balance = mean(Default$balance),
income = mean(Default$income), student = "No")
yes2.prob <- predict(mglm.fit, yes.dat2, type = "response")
no2.prob <- predict(mglm.fit, no.dat2, type = "response")
yes2.prob ; no2.prob
boxplot(balance ~ student, data = Default)
x = c(410, 500, 471, 619, 584, 681, 399, 481, 624, 589)
y = c(0, 1, 0, 1, 0, 1, 0, 1, 1, 1)
X = cbind(x)
reg_res = mult_reg(X, y, alpha = 0.05, coeff = TRUE)
reg_res$beta_hat
source("functions/mult_reg.R", echo = FALSE)
IRWLS_res = irwls_logistic_reg(X, y)
simp_res = mult_reg(X, y, alpha = 0.05, coeff = TRUE)
MSE = simp_res$MSE
W = IRWLS_res$W
one = c(rep(1, length(x)))
X = cbind(one, x)
## 단순회귀 beta_hat 분산
var_beta_hat_LSE = MSE * solve(t(X) %*% X)
## IRWLS beta_hat 분산
var_beta_hat_IRWLS = solve(t(X) %*% W %*% X)
var_beta_hat_LSE ; var_beta_hat_IRWLS
beta_hat_IRWLS = IRWLS_res$beta_hat
score = t(c(1, 550)) %*% beta_hat_IRWLS
p_hat_y_1_x_500 = exp(score) / (1 + exp(score))
p_hat_y_1_x_500
library(ISLR)
library(dplyr)
dataset_default = Default %>% na.omit()
X = dataset_default %>%
dplyr::select(balance:income)
y = ifelse(dataset_default$default == "Yes", 1, 0)
X = as.matrix(X)
default_irwls_res = irwls_logistic_reg(X, y, tol = 1e-8)
glm_res <- glm(default ~ balance + income, data = Default, family = binomial)
glm_res$coefficients
summary(glm_res)
anova(glm_res)
x = c(12, 15, 42, 52, 59, 73, 82, 91, 96, 105, 114, 120, 121, 128, 130, 139, 139, 157,
1, 1, 2, 8, 11, 18, 22, 31, 37, 61, 72, 81, 97, 112, 118, 127, 131, 140, 151, 159, 177, 206)
y = c(rep(1, 18), rep(0, 22))
X = cbind(x)
IRWLS_res = irwls_logistic_reg(X, y)
GLM_res = glm(y ~ x, family = binomial)
GLM_res$coefficients
summary(GLM_res)
anova(GLM_res)
op <- par(no.readonly = TRUE)
par(mar = c(5, 4, 4, 8) + 0.1)
plot(y ~ x, col = ifelse(y == 1, "lightblue", "blue"), cex = 0.85)
par(xpd = NA)
legend("topright",
legend = c("kyphosis = yes", "kyphosis = no"),
inset  = c(-0.25, 0),
col    = c("lightblue", "blue"),
lty    = 1,
cex    = 0.6,
bg     = "white")
par(op)
op <- par(no.readonly = TRUE)
par(mar = c(5, 4, 4, 8) + 0.1)
plot(x ~ y, col = ifelse(y == 1, "lightblue", "blue"), cex = 0.85)
par(xpd = NA)
legend("topright",
legend = c("kyphosis = yes", "kyphosis = no"),
inset  = c(-0.25, 0),
col    = c("lightblue", "blue"),
lty    = 1,
cex    = 0.6,
bg     = "white")
par(op)
X_df = data.frame(X)
kyphosis_yes_prob = predict(GLM_res, X_df, type = "response")
plot(x = x, y = kyphosis_yes_prob, xlab = "age", ylab = "P(kyphosis = yes | age)",
lwd = 1.0, col = "lightblue", cex = 0.8, pch = 21, bg  = "lightblue")
X = cbind(x, x^2)
colnames(X) = c("age", "age^2")
IRWLS_res = irwls_logistic_reg(X, y)
GLM_res = glm(y ~ X, family = binomial)
GLM_res$coefficients
summary(GLM_res)
anova(GLM_res)
X_df = data.frame(X)
kyphosis_yes_prob = predict(GLM_res, X_df, type = "response")
plot(x = x, y = kyphosis_yes_prob, xlab = "age", ylab = "P(kyphosis = yes | age)",
lwd = 1.0, col = "lightblue", cex = 0.8, pch = 21, bg  = "lightblue")
x11 = c(rep(1, 484)) ; y11 = c(rep(1, 484))
x12 = c(rep(1, 27)) ; y12 = c(rep(0, 27))
x21 = c(rep(0, 385)) ; y21 = c(rep(1, 385))
x22 = c(rep(0, 90)) ; y22 = c(rep(0, 90))
x = c(x11, x12, x21, x22) ; y = c(y11, y12, y21, y22)
X = cbind(x)
IRWLS_res = irwls_logistic_reg(X, y)
GLM_res = glm(y ~ X, family = binomial)
GLM_res$coefficients
summary(GLM_res)
anova(GLM_res)
x11 = c(rep(1, 484)) ; y11 = c(rep(1, 484))
x12 = c(rep(1, 27)) ; y12 = c(rep(0, 27))
x21 = c(rep(0, 385)) ; y21 = c(rep(1, 385))
x22 = c(rep(0, 90)) ; y22 = c(rep(0, 90))
y = c(x11, x12, x21, x22) ; x = c(y11, y12, y21, y22)
X = cbind(x)
IRWLS_res = irwls_logistic_reg(X, y)
GLM_res = glm(y ~ X, family = binomial)
GLM_res$coefficients
summary(GLM_res)
anova(GLM_res)
gc()
