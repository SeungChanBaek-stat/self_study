LjungBox(fit1, lags = seq(6, 24, 6)) # 잔차의 포트맨토 검정
sarima(ex7_5c, 0,1,1) # sarima를 이용한 모형 적합을 이용한 경우
sarima.for(ex7_5c, 6, 0, 1, 1) # 예측값의 시계열 그림
sarima.for(ex7_5c, 12, 0, 1, 1) # 예측값의 시계열 그림
dl_c = durbin_levinson(diff_c_1, K = 10)
sacf = dl_c$SACF ; spacf = dl_c$SPACF
z_bar = mean(ex7_5c) ; z_sd = sd(ex7_5c)
ex8_1(sacf = sacf, spacf = spacf, n = n, z_bar = z_bar, z_sd = z_sd, diff = TRUE)
fit2 = arima(ex7_5c, order = c(0,1,1), xreg  = X1) # 차분된 MA(1) 모형 적합
coeftest(fit2)
?arima
x0 <- rep(1, n)
fit2 = arima(ex7_5c, order = c(0,1,1), xreg = x0) # 차분된 MA(1) 모형 적합
coeftest(fit2)
library(glue)
z = scan(glue(dataset_dir, "/ex7_5c.txt"))
n = length(z)
ex7_5c = ts(z)
ts.plot(ex7_5c, ylab = "ex7_5c", main = "모의실험 자료")
acf(ex7_5c, lag.max = 24, main = "ex7_5c의 SACF")
pacf(ex7_5c, lag.max = 12, main = "ex7_5c의 SPACF")
adfTest(ex7_5c, lags = 0, type = "ct") # ct : case3 ; 절편이 있고 추세도 있는 경우
adfTest(ex7_5c, lags = 1, type = "ct")
adfTest(ex7_5c, lags = 2, type = "ct")
diff_c_1 = diff(ex7_5c, lag = 1)
ts.plot(diff_c_1, ylab = "diff_c_1", main = "1차 차분된 모의실험 자료")
acf(diff_c_1, lag.max = 24, main = "1차 차분된 ex7_5c의 SACF")
pacf(diff_c_1, lag.max = 24, main = "1차 차분된 ex7_5c의 SPACF")
fit1 = arima(ex7_5c, order = c(0,1,1)) # 차분된 MA(1) 모형 적합
coeftest(fit1)
sum(fit2$residuals^2)/n
ts.plot(fit1$residuals, main = "적합된 모형의 잔차 시계열그림"); abline(h = 0)
acf2(fit1$residuals, max.lag = 24, main = "적합된 모형의 잔차 SACF와 SPACF")
qqnorm(resid(fit1), main = "적합된 모형의 잔차의 정규성검정")
qqline(resid(fit1), col = "red")
LjungBox(fit1, lags = seq(6, 24, 6)) # 잔차의 포트맨토 검정
sarima(ex7_5c, 0,1,1) # sarima를 이용한 모형 적합을 이용한 경우
sarima.for(ex7_5c, 6, 0, 1, 1) # 예측값의 시계열 그림
sarima.for(ex7_5c, 12, 0, 1, 1) # 예측값의 시계열 그림
dl_c = durbin_levinson(diff_c_1, K = 10)
sacf = dl_c$SACF ; spacf = dl_c$SPACF
z_bar = mean(ex7_5c) ; z_sd = sd(ex7_5c)
ex8_1(sacf = sacf, spacf = spacf, n = n, z_bar = z_bar, z_sd = z_sd, diff = TRUE)
x0 <- rep(1, n)
fit2 = arima(ex7_5c, order = c(0,1,1), xreg = x0) # 차분된 MA(1) 모형 적합
coeftest(fit2)
n = length(z) ; n
length(x0)
x0 <- rep(1, n)
length(x0)
fit2 = arima(ex7_5c, order = c(0,1,1), xreg = x0) # 차분된 MA(1) 모형 적합
coeftest(fit2)
library(forecast)
fit2 <- Arima(ex7_5c, order = c(0,1,1), include.constant = TRUE)
coeftest(fit2)
library(glue)
z = scan(glue(dataset_dir, "/ex7_5c.txt"))
n = length(z) ; n
ex7_5c = ts(z)
ts.plot(ex7_5c, ylab = "ex7_5c", main = "모의실험 자료")
acf(ex7_5c, lag.max = 24, main = "ex7_5c의 SACF")
pacf(ex7_5c, lag.max = 12, main = "ex7_5c의 SPACF")
adfTest(ex7_5c, lags = 0, type = "ct") # ct : case3 ; 절편이 있고 추세도 있는 경우
adfTest(ex7_5c, lags = 1, type = "ct")
adfTest(ex7_5c, lags = 2, type = "ct")
diff_c_1 = diff(ex7_5c, lag = 1)
ts.plot(diff_c_1, ylab = "diff_c_1", main = "1차 차분된 모의실험 자료")
acf(diff_c_1, lag.max = 24, main = "1차 차분된 ex7_5c의 SACF")
pacf(diff_c_1, lag.max = 24, main = "1차 차분된 ex7_5c의 SPACF")
fit1 = arima(ex7_5c, order = c(0,1,1)) # 차분된 MA(1) 모형 적합
coeftest(fit1)
sum(fit2$residuals^2)/n
ts.plot(fit1$residuals, main = "적합된 모형의 잔차 시계열그림"); abline(h = 0)
acf2(fit1$residuals, max.lag = 24, main = "적합된 모형의 잔차 SACF와 SPACF")
qqnorm(resid(fit1), main = "적합된 모형의 잔차의 정규성검정")
qqline(resid(fit1), col = "red")
LjungBox(fit1, lags = seq(6, 24, 6)) # 잔차의 포트맨토 검정
sarima(ex7_5c, 0,1,1) # sarima를 이용한 모형 적합을 이용한 경우
sarima.for(ex7_5c, 6, 0, 1, 1) # 예측값의 시계열 그림
sarima.for(ex7_5c, 12, 0, 1, 1) # 예측값의 시계열 그림
dl_c = durbin_levinson(diff_c_1, K = 10)
sacf = dl_c$SACF ; spacf = dl_c$SPACF
z_bar = mean(ex7_5c) ; z_sd = sd(ex7_5c)
ex8_1(sacf = sacf, spacf = spacf, n = n, z_bar = z_bar, z_sd = z_sd, diff = TRUE)
library(glue)
z = scan(glue(dataset_dir, "/ex7_5d.txt"))
length(z)
ex7_5d = ts(z)
ts.plot(ex7_5d, ylab = "ex7_5d", main = "모의실험 자료")
acf(ex7_5d, lag.max = 24, main = "ex7_5d의 SACF")
pacf(ex7_5d, lag.max = 12, main = "ex7_5d의 SPACF")
diff_d_1 = diff(ex7_5d, lag = 1)
ts.plot(diff_d_1, ylab = "diff_d_1", main = "1차 차분된 모의실험 자료")
acf(diff_d_1, lag.max = 24, main = "1차 차분된 ex7_5d의 SACF")
pacf(diff_d_1, lag.max = 24, main = "1차 차분된 ex7_5d의 SPACF")
adfTest(ex7_5c, lags = 0, type = "c") # ct : case3 ; 절편이 있고 추세도 있는 경우
adfTest(ex7_5c, lags = 1, type = "c")
adfTest(ex7_5c, lags = 2, type = "c")
adfTest(ex7_5b, lags = 0, type = "c") # ct : case3 ; 절편이 있고 추세도 있는 경우
adfTest(ex7_5b, lags = 1, type = "c")
adfTest(ex7_5b, lags = 2, type = "c")
adfTest(ex7_5d, lags = 0, type = "ct") # ct : case3 ; 절편이 있고 추세도 있는 경우
adfTest(ex7_5d, lags = 1, type = "ct")
adfTest(ex7_5d, lags = 2, type = "ct")
library(glue)
z = scan(glue(dataset_dir, "/ex7_5d.txt"))
n = length(z)
ex7_5d = ts(z)
ts.plot(ex7_5d, ylab = "ex7_5d", main = "모의실험 자료")
acf(ex7_5d, lag.max = 24, main = "ex7_5d의 SACF")
pacf(ex7_5d, lag.max = 12, main = "ex7_5d의 SPACF")
adfTest(ex7_5d, lags = 0, type = "ct") # ct : case3 ; 절편이 있고 추세도 있는 경우
adfTest(ex7_5d, lags = 1, type = "ct")
adfTest(ex7_5d, lags = 2, type = "ct")
diff_d_1 = diff(ex7_5d, lag = 1)
ts.plot(diff_d_1, ylab = "diff_d_1", main = "1차 차분된 모의실험 자료")
acf(diff_d_1, lag.max = 24, main = "1차 차분된 ex7_5d의 SACF")
pacf(diff_d_1, lag.max = 24, main = "1차 차분된 ex7_5d의 SPACF")
library(glue)
z = scan(glue(dataset_dir, "/ex7_5d.txt"))
n = length(z)
ex7_5d = ts(z)
ts.plot(ex7_5d, ylab = "ex7_5d", main = "모의실험 자료")
acf(ex7_5d, lag.max = 24, main = "ex7_5d의 SACF")
pacf(ex7_5d, lag.max = 12, main = "ex7_5d의 SPACF")
adfTest(ex7_5d, lags = 0, type = "ct") # ct : case3 ; 절편이 있고 추세도 있는 경우
adfTest(ex7_5d, lags = 1, type = "ct")
adfTest(ex7_5d, lags = 2, type = "ct")
diff_d_1 = diff(ex7_5d, lag = 1)
ts.plot(diff_d_1, ylab = "diff_d_1", main = "1차 차분된 모의실험 자료")
acf(diff_d_1, lag.max = 24, main = "1차 차분된 ex7_5d의 SACF")
pacf(diff_d_1, lag.max = 24, main = "1차 차분된 ex7_5d의 SPACF")
diff_d_2 = diff(diff_d_1, lag = 1)
ts.plot(diff_d_2, ylab = "diff_d_2", main = "2차 차분된 모의실험 자료")
acf(diff_d_2, lag.max = 24, main = "2차 차분된 ex7_5d의 SACF")
pacf(diff_d_2, lag.max = 24, main = "2차 차분된 ex7_5d의 SPACF")
library(glue)
z = scan(glue(dataset_dir, "/ex7_5d.txt"))
n = length(z)
ex7_5d = ts(z)
ts.plot(ex7_5d, ylab = "ex7_5d", main = "모의실험 자료")
acf(ex7_5d, lag.max = 24, main = "ex7_5d의 SACF")
pacf(ex7_5d, lag.max = 12, main = "ex7_5d의 SPACF")
adfTest(ex7_5d, lags = 0, type = "ct") # ct : case3 ; 절편이 있고 추세도 있는 경우
adfTest(ex7_5d, lags = 1, type = "ct")
adfTest(ex7_5d, lags = 2, type = "ct")
diff_d_1 = diff(ex7_5d, lag = 1)
ts.plot(diff_d_1, ylab = "diff_d_1", main = "1차 차분된 모의실험 자료")
acf(diff_d_1, lag.max = 24, main = "1차 차분된 ex7_5d의 SACF")
pacf(diff_d_1, lag.max = 24, main = "1차 차분된 ex7_5d의 SPACF")
library(glue)
z = scan(glue(dataset_dir, "/ex7_5d.txt"))
n = length(z)
ex7_5d = ts(z)
ts.plot(ex7_5d, ylab = "ex7_5d", main = "모의실험 자료")
acf(ex7_5d, lag.max = 24, main = "ex7_5d의 SACF")
pacf(ex7_5d, lag.max = 12, main = "ex7_5d의 SPACF")
adfTest(ex7_5d, lags = 0, type = "ct") # ct : case3 ; 절편이 있고 추세도 있는 경우
adfTest(ex7_5d, lags = 1, type = "ct")
adfTest(ex7_5d, lags = 2, type = "ct")
diff_d_1 = diff(ex7_5d, lag = 1)
ts.plot(diff_d_1, ylab = "diff_d_1", main = "1차 차분된 모의실험 자료")
acf(diff_d_1, lag.max = 24, main = "1차 차분된 ex7_5d의 SACF")
pacf(diff_d_1, lag.max = 24, main = "1차 차분된 ex7_5d의 SPACF")
fit1 = arima(ex7_5d, order = c(2,1,2)) # 차분된 MA(1) 모형 적합
coeftest(fit1)
sum(fit2$residuals^2)/n
ts.plot(fit1$residuals, main = "적합된 모형의 잔차 시계열그림"); abline(h = 0)
acf2(fit1$residuals, max.lag = 24, main = "적합된 모형의 잔차 SACF와 SPACF")
qqnorm(resid(fit1), main = "적합된 모형의 잔차의 정규성검정")
qqline(resid(fit1), col = "red")
LjungBox(fit1, lags = seq(6, 24, 6)) # 잔차의 포트맨토 검정
sarima(ex7_5d, 2,1,2) # sarima를 이용한 모형 적합을 이용한 경우
sarima.for(ex7_5d, 6, 2, 1, 2) # 예측값의 시계열 그림
sarima.for(ex7_5d, 12, 2, 1, 2) # 예측값의 시계열 그림
library(glue)
z = scan(glue(dataset_dir, "/ex7_5d.txt"))
n = length(z)
ex7_5d = ts(z)
ts.plot(ex7_5d, ylab = "ex7_5d", main = "모의실험 자료")
acf(ex7_5d, lag.max = 24, main = "ex7_5d의 SACF")
pacf(ex7_5d, lag.max = 12, main = "ex7_5d의 SPACF")
adfTest(ex7_5d, lags = 0, type = "ct") # ct : case3 ; 절편이 있고 추세도 있는 경우
adfTest(ex7_5d, lags = 1, type = "ct")
adfTest(ex7_5d, lags = 2, type = "ct")
diff_d_1 = diff(ex7_5d, lag = 1)
ts.plot(diff_d_1, ylab = "diff_d_1", main = "1차 차분된 모의실험 자료")
acf(diff_d_1, lag.max = 24, main = "1차 차분된 ex7_5d의 SACF")
pacf(diff_d_1, lag.max = 24, main = "1차 차분된 ex7_5d의 SPACF")
fit1 = arima(ex7_5d, order = c(2,1,0)) # 차분된 MA(1) 모형 적합
coeftest(fit1)
sum(fit2$residuals^2)/n
ts.plot(fit1$residuals, main = "적합된 모형의 잔차 시계열그림"); abline(h = 0)
acf2(fit1$residuals, max.lag = 24, main = "적합된 모형의 잔차 SACF와 SPACF")
qqnorm(resid(fit1), main = "적합된 모형의 잔차의 정규성검정")
qqline(resid(fit1), col = "red")
LjungBox(fit1, lags = seq(6, 24, 6)) # 잔차의 포트맨토 검정
sarima(ex7_5d, 2,1,0) # sarima를 이용한 모형 적합을 이용한 경우
sarima.for(ex7_5d, 6, 2, 1, 0) # 예측값의 시계열 그림
sarima.for(ex7_5d, 12, 2, 1, 0) # 예측값의 시계열 그림
fit1 = arima(ex7_5d, order = c(2,1,0)) # 차분된 AR(2) 모형 적합
coeftest(fit1)
sum(fit1$residuals^2)/n
fit2 = arima(ex7_5d, order = c(0,1,2)) # 차분된 MA(2) 모형 적합
coeftest(fit2)
sum(fit2$residuals^2)/n
library(glue)
z = scan(glue(dataset_dir, "/ex7_5e.txt"))
length(z)
ex7_5e = ts(z)
ts.plot(ex7_5e, ylab = "ex7_5e", main = "모의실험 자료")
acf(ex7_5e, lag.max = 24, main = "ex7_5e의 SACF")
pacf(ex7_5e, lag.max = 12, main = "ex7_5e의 SPACF")
diff_e_1 = diff(ex7_5e, lag = 1)
ts.plot(diff_e_1, ylab = "diff_e_1", main = "1차 차분된 모의실험 자료")
acf(diff_e_1, lag.max = 24, main = "1차 차분된 ex7_5e의 SACF")
pacf(diff_e_1, lag.max = 24, main = "1차 차분된 ex7_5e의 SPACF")
adfTest(ex7_5e, lags = 0, type = "c") # c : case2 ; 절편이 있고 추세도 있는 경우
adfTest(ex7_5e, lags = 1, type = "c")
adfTest(ex7_5e, lags = 2, type = "c")
library(glue)
z = scan(glue(dataset_dir, "/ex7_5e.txt"))
length(z)
ex7_5e = ts(z)
ts.plot(ex7_5e, ylab = "ex7_5e", main = "모의실험 자료")
acf(ex7_5e, lag.max = 24, main = "ex7_5e의 SACF")
pacf(ex7_5e, lag.max = 12, main = "ex7_5e의 SPACF")
adfTest(ex7_5e, lags = 0, type = "c") # c : case2 ; 절편이 있고 추세도 있는 경우
adfTest(ex7_5e, lags = 1, type = "c")
adfTest(ex7_5e, lags = 2, type = "c")
library(glue)
z = scan(glue(dataset_dir, "/ex7_5e.txt"))
length(z)
ex7_5e = ts(z)
ts.plot(ex7_5e, ylab = "ex7_5e", main = "모의실험 자료")
acf(ex7_5e, lag.max = 24, main = "ex7_5e의 SACF")
pacf(ex7_5e, lag.max = 12, main = "ex7_5e의 SPACF")
adfTest(ex7_5e, lags = 0, type = "c") # c : case2 ; 절편이 있고 추세도 있는 경우
adfTest(ex7_5e, lags = 1, type = "c")
adfTest(ex7_5e, lags = 2, type = "c")
fit1 = arima(ex7_5d, order = c(1,0,0)) # AR(1) 모형 적합
coeftest(fit1)
sum(fit1$residuals^2)/n
ts.plot(fit1$residuals, main = "적합된 모형의 잔차 시계열그림"); abline(h = 0)
acf2(fit1$residuals, max.lag = 24, main = "적합된 모형의 잔차 SACF와 SPACF")
qqnorm(resid(fit1), main = "적합된 모형의 잔차의 정규성검정")
qqline(resid(fit1), col = "red")
LjungBox(fit1, lags = seq(6, 24, 6)) # 잔차의 포트맨토 검정
sarima(ex7_5e, 1,0,0) # sarima를 이용한 모형 적합을 이용한 경우
sarima.for(ex7_5e, 6, 1, 0, 0) # 예측값의 시계열 그림
sarima.for(ex7_5e, 12, 1, 0, 0) # 예측값의 시계열 그림
library(glue)
z = scan(glue(dataset_dir, "/ex7_5e.txt"))
length(z)
ex7_5e = ts(z)
ts.plot(ex7_5e, ylab = "ex7_5e", main = "모의실험 자료")
acf(ex7_5e, lag.max = 24, main = "ex7_5e의 SACF")
pacf(ex7_5e, lag.max = 12, main = "ex7_5e의 SPACF")
adfTest(ex7_5e, lags = 0, type = "c") # c : case2 ; 절편이 있고 추세도 있는 경우
adfTest(ex7_5e, lags = 1, type = "c")
adfTest(ex7_5e, lags = 2, type = "c")
fit1 = arima(ex7_5d, order = c(1,0,0)) # AR(1) 모형 적합
coeftest(fit1)
sum(fit1$residuals^2)/n
ts.plot(fit1$residuals, main = "적합된 모형의 잔차 시계열그림"); abline(h = 0)
acf2(fit1$residuals, max.lag = 24, main = "적합된 모형의 잔차 SACF와 SPACF")
qqnorm(resid(fit1), main = "적합된 모형의 잔차의 정규성검정")
qqline(resid(fit1), col = "red")
LjungBox(fit1, lags = seq(6, 24, 6)) # 잔차의 포트맨토 검정
sarima(ex7_5e, 1,0,0) # sarima를 이용한 모형 적합을 이용한 경우
sarima.for(ex7_5e, 6, 1, 0, 0) # 예측값의 시계열 그림
sarima.for(ex7_5e, 12, 1, 0, 0) # 예측값의 시계열 그림
fit2 = arima(ex7_5d, order = c(1,0,0), include.mean = FALSE) # AR(1) 모형 적합
library(glue)
z = scan(glue(dataset_dir, "/ex7_5e.txt"))
length(z)
ex7_5e = ts(z)
ts.plot(ex7_5e, ylab = "ex7_5e", main = "모의실험 자료")
acf(ex7_5e, lag.max = 24, main = "ex7_5e의 SACF")
pacf(ex7_5e, lag.max = 12, main = "ex7_5e의 SPACF")
adfTest(ex7_5e, lags = 0, type = "c") # c : case2 ; 절편이 있고 추세도 있는 경우
adfTest(ex7_5e, lags = 1, type = "c")
adfTest(ex7_5e, lags = 2, type = "c")
fit1 = arima(ex7_5d, order = c(1,0,0)) # AR(1) 모형 적합
coeftest(fit1)
sum(fit1$residuals^2)/n
ts.plot(fit1$residuals, main = "적합된 모형의 잔차 시계열그림"); abline(h = 0)
acf2(fit1$residuals, max.lag = 24, main = "적합된 모형의 잔차 SACF와 SPACF")
qqnorm(resid(fit1), main = "적합된 모형의 잔차의 정규성검정")
qqline(resid(fit1), col = "red")
LjungBox(fit1, lags = seq(6, 24, 6)) # 잔차의 포트맨토 검정
sarima(ex7_5e, 1,0,0) # sarima를 이용한 모형 적합을 이용한 경우
sarima.for(ex7_5e, 6, 1, 0, 0) # 예측값의 시계열 그림
sarima.for(ex7_5e, 12, 1, 0, 0) # 예측값의 시계열 그림
fit2 = arima(ex7_5d, order = c(1,0,0), include.mean = FALSE, method = "ML") # AR(1) 모형 적합
coeftest(fit2)
sum(fit2$residuals^2)/n
ts.plot(fit2$residuals, main = "적합된 모형의 잔차 시계열그림"); abline(h = 0)
acf2(fit2$residuals, max.lag = 24, main = "적합된 모형의 잔차 SACF와 SPACF")
qqnorm(resid(fit2), main = "적합된 모형의 잔차의 정규성검정")
qqline(resid(fit2), col = "red")
LjungBox(fit2, lags = seq(6, 24, 6)) # 잔차의 포트맨토 검정
sarima(ex7_5e, 1,0,0) # sarima를 이용한 모형 적합을 이용한 경우
sarima.for(ex7_5e, 6, 1, 0, 0) # 예측값의 시계열 그림
sarima.for(ex7_5e, 12, 1, 0, 0) # 예측값의 시계열 그림
library(glue)
z = scan(glue(dataset_dir, "/interest.txt"))
n = length(z)
interest = ts(z, frequency = 12)
ts.plot(interest, ylab = "interest", main = "이자율 자료")
acf(interest, lag.max = 24, main = "이자율의 SACF")
pacf(interest, lag.max = 24, main = "이자율의 SPACF")
library(glue)
z = scan(glue(dataset_dir, "/interest.txt"))
n = length(z)
interest = ts(z)
ts.plot(interest, ylab = "interest", main = "이자율 자료")
acf(interest, lag.max = 24, main = "이자율의 SACF")
pacf(interest, lag.max = 24, main = "이자율의 SPACF")
library(glue)
z = scan(glue(dataset_dir, "/interest.txt"))
n = length(z)
interest = ts(z)
ts.plot(interest, ylab = "interest", main = "이자율 자료")
acf(interest, lag.max = 24, main = "이자율의 SACF")
pacf(interest, lag.max = 24, main = "이자율의 SPACF")
adfTest(interest, lags = 0, type = "c") # c : case2 ; 절편이 있고 추세도 있는 경우
adfTest(interest, lags = 1, type = "c")
adfTest(interest, lags = 2, type = "c")
library(glue)
z = scan(glue(dataset_dir, "/interest.txt"))
n = length(z)
interest = ts(z)
ts.plot(interest, ylab = "interest", main = "이자율 자료")
acf(interest, lag.max = 24, main = "이자율의 SACF")
pacf(interest, lag.max = 24, main = "이자율의 SPACF")
adfTest(interest, lags = 0, type = "c") # c : case2 ; 절편이 있고 추세도 있는 경우
adfTest(interest, lags = 1, type = "c")
adfTest(interest, lags = 2, type = "c")
diff_int = diff(interest, lag = 1)
ts.plot(diff_int, ylab = "diff_int", main = "1차 차분된 이자율 자료")
acf(diff_int, lag.max = 24, main = "1차 차분된 이자율의 SACF")
pacf(diff_int, lag.max = 24, main = "1차 차분된 이자율의 SPACF")
library(glue)
z = scan(glue(dataset_dir, "/interest.txt"))
n = length(z)
interest = ts(z)
ts.plot(interest, ylab = "interest", main = "이자율 자료")
acf(interest, lag.max = 24, main = "이자율의 SACF")
pacf(interest, lag.max = 24, main = "이자율의 SPACF")
adfTest(interest, lags = 0, type = "c") # c : case2 ; 절편이 있고 추세도 있는 경우
adfTest(interest, lags = 1, type = "c")
adfTest(interest, lags = 2, type = "c")
diff_int = diff(interest, lag = 1)
ts.plot(diff_int, ylab = "diff_int", main = "1차 차분된 이자율 자료")
acf(diff_int, lag.max = 24, main = "1차 차분된 이자율의 SACF")
pacf(diff_int, lag.max = 24, main = "1차 차분된 이자율의 SPACF")
fit1 = arima(interest, order = c(1,1,0)) # 1차 차분된 AR(1) 모형 적합
coeftest(fit1)
sum(fit1$residuals^2)/n
fit2 = arima(interest, order = c(0,1,1)) # 1차 차분된 MA(1) 모형 적합
coeftest(fit2)
sum(fit2$residuals^2)/n
library(glue)
z = scan(glue(dataset_dir, "/interest.txt"))
n = length(z)
interest = ts(z)
ts.plot(interest, ylab = "interest", main = "이자율 자료")
acf(interest, lag.max = 24, main = "이자율의 SACF")
pacf(interest, lag.max = 24, main = "이자율의 SPACF")
adfTest(interest, lags = 0, type = "c") # c : case2 ; 절편이 있고 추세도 있는 경우
adfTest(interest, lags = 1, type = "c")
adfTest(interest, lags = 2, type = "c")
diff_int = diff(interest, lag = 1)
ts.plot(diff_int, ylab = "diff_int", main = "1차 차분된 이자율 자료")
acf(diff_int, lag.max = 24, main = "1차 차분된 이자율의 SACF")
pacf(diff_int, lag.max = 24, main = "1차 차분된 이자율의 SPACF")
fit1 = arima(interest, order = c(1,1,0)) # 1차 차분된 AR(1) 모형 적합
coeftest(fit1)
sum(fit1$residuals^2)/n
fit2 = arima(interest, order = c(0,1,1)) # 1차 차분된 MA(1) 모형 적합
coeftest(fit2)
sum(fit2$residuals^2)/n
ts.plot(fit1$residuals, main = "적합된 모형의 잔차 시계열그림"); abline(h = 0)
acf2(fit1$residuals, max.lag = 24, main = "적합된 모형의 잔차 SACF와 SPACF")
qqnorm(resid(fit1), main = "적합된 모형의 잔차의 정규성검정")
qqline(resid(fit1), col = "red")
LjungBox(fit1, lags = seq(6, 24, 6)) # 잔차의 포트맨토 검정
sarima(interest, 1,1,0) # sarima를 이용한 모형 적합을 이용한 경우
sarima.for(interest, 6, 1, 1, 0) # 예측값의 시계열 그림
sarima.for(interest, 12, 1, 1, 0) # 예측값의 시계열 그림
5 + (-0.2)*(1.08) + (0.3)*(2.6)
2 + (-0.2) * (5.564) + (0.3)*(1.08)
(0.2)*(1.2112) - (0.3)*(5.564)
(0.3)*(1.2112)
knitr::opts_chunk$set(echo = TRUE)
library(glue)
list.files("../adv_reg/functions")
dir = getwd() ; mother_dir = dirname(dir)
dataset_dir = glue(dir, "/datasets", sep = "")
reg_function_dir = glue(mother_dir, "/adv_reg/functions")
source(glue(reg_function_dir, "/mult_reg.R", sep = ""), echo = F)
source(glue(reg_function_dir, "/reg_diagnostics.R", sep = ""), echo = F)
tsa_function_dir = glue(mother_dir, "/tsa/functions")
source(glue(tsa_function_dir, "/exp_smt.R", sep = ""), echo = F)
source(glue(tsa_function_dir, "/acf_pacf.R", sep = ""), echo = F)
## Example 8.6 : 가스로 자료 분석
# install.packages("portes") ; install.packages("lmtest")
library(glue)
library(astsa) # library for function acf2 & sarima
z = scan(glue(dataset_dir, "/eg8_7.txt"))
ts.plot(z, ylab = "z", main = "Simulated AR(1) Process")
acf2(z, max.lag = 24, main = "AR(1)과정의 ACF & PACF")
sarima.for(z, 25, 1,0,0) # 그림 9-1 관측값과 예측값
## Example 8.6 : 가스로 자료 분석
# install.packages("portes") ; install.packages("lmtest")
library(glue)
library(astsa) # library for function acf2 & sarima.for
z = scan(glue(dataset_dir, "/eg8_7.txt"))
ts.plot(z, ylab = "z", main = "Simulated AR(1) Process")
acf2(z, max.lag = 24, main = "AR(1)과정의 ACF & PACF")
sarima.for(z, 25, 1,0,0) # 그림 9-1 관측값과 예측값
## Example 8.6 : 가스로 자료 분석
# install.packages("portes") ; install.packages("lmtest")
library(glue)
library(astsa) # library for function acf2 & sarima.for
z = scan(glue(dataset_dir, "/eg8_7.txt"))
ts.plot(z, ylab = "z", main = "Simulated AR(1) Process")
acf2(z, max.lag = 24, main = "AR(1)과정의 ACF & PACF")
sarima.for(z, 25,1,0,0) # 그림 9-1 관측값과 예측값
## Example 8.6 : 가스로 자료 분석
# install.packages("portes") ; install.packages("lmtest")
library(glue)
library(astsa) # library for function acf2 & sarima.for
z = scan(glue(dataset_dir, "/eg8_7.txt"))
ts.plot(z, ylab = "z", main = "Simulated AR(1) Process")
acf2(z, max.lag = 24, main = "AR(1)과정의 ACF & PACF")
sarima(z, 1,0,0)
sarima.for(z, 25,1,0,0) # 그림 9-1 관측값과 예측값
## Example 8.6 : 가스로 자료 분석
# install.packages("portes") ; install.packages("lmtest")
library(glue)
library(astsa) # library for function acf2 & sarima.for
z = scan(glue(dataset_dir, "/eg8_7.txt"))
ts.plot(z, ylab = "z", main = "Simulated AR(1) Process")
acf2(z, max.lag = 24, main = "AR(1)과정의 ACF & PACF")
sarima(z, 1,0,0)
sarima.for(z, 24,1,0,0) # 그림 9-1 관측값과 예측값
# sarima(z, 1,0,0)
sarima.for(z,6,1,0,0) # 그림 9-1 관측값과 예측값
## Example 8.6 : 가스로 자료 분석
# install.packages("portes") ; install.packages("lmtest")
library(glue)
library(astsa) # library for function acf2 & sarima.for
z = scan(glue(dataset_dir, "/eg8_7.txt"))
z = ts(z)
ts.plot(z, ylab = "z", main = "Simulated AR(1) Process")
acf2(z, max.lag = 24, main = "AR(1)과정의 ACF & PACF")
# sarima(z, 1,0,0)
sarima.for(z,6,1,0,0) # 그림 9-1 관측값과 예측값
## Example 8.6 : 가스로 자료 분석
# install.packages("portes") ; install.packages("lmtest")
library(glue)
library(astsa) # library for function acf2 & sarima.for
z = scan(glue(dataset_dir, "/eg8_7.txt"))
z = ts(z)
ts.plot(z, ylab = "z", main = "Simulated AR(1) Process")
acf2(z, max.lag = 24, main = "AR(1)과정의 ACF & PACF")
# sarima(z, 1,0,0)
sarima.for(z,25,1,0,0) # 그림 9-1 관측값과 예측값
## Example 9.5 : IMA(1,1)과정의 적합 및 예측
# install.packages("portes") ; install.packages("lmtest")
library(glue)
library(astsa) # library for function acf2 & sarima.for
z = scan(glue(dataset_dir, "/eg9_5.txt"))
z = ts(z)
ts.plot(z, ylab = "z", main = "그림 9-2 모의실험 자료")
acf2(z, max.lag = 24, main = "그림 9-2 SACF & SPACF")
ts.plot(diff(z), main = "그림 9-3 1차 차분된 모의실험 자료"); abline(h = 0)
acf2(diff(z), max.lag = 24, main = "그림 9-3 SACF & SPACF")
fit = arima(z, order = c(0,1,1))
ts.plot(resid(fit), main = "그림 9-4 ARIMA(0,1,1) 적합후의 잔차"); abline(h = 0)
acf2(resid(fit), main = "그림 9-4 잔차의 SACF & SPACF")
sarima(z,0,1,1) # Fig 9.4
sarima.for(z, 25, 0,1,1)
# sarima(z, 1,0,0)
sarima.for(z,25,1,0,0) # 그림 9-1 관측값과 예측값
## Example 9.5 : IMA(1,1)과정의 적합 및 예측
# install.packages("portes") ; install.packages("lmtest")
library(glue)
library(astsa) # library for function acf2 & sarima.for
z = scan(glue(dataset_dir, "/eg9_5.txt"))
z = ts(z)
ts.plot(z, ylab = "z", main = "그림 9-2 모의실험 자료")
acf2(z, max.lag = 24, main = "그림 9-2 SACF & SPACF")
ts.plot(diff(z), main = "그림 9-3 1차 차분된 모의실험 자료"); abline(h = 0)
acf2(diff(z), max.lag = 24, main = "그림 9-3 SACF & SPACF")
fit = arima(z, order = c(0,1,1))
ts.plot(resid(fit), main = "그림 9-4 ARIMA(0,1,1) 적합후의 잔차"); abline(h = 0)
acf2(resid(fit), main = "그림 9-4 잔차의 SACF & SPACF")
sarima(z,0,1,1) # Fig 9.4
sarima.for(z, 25, 0,1,1)
## Example 9.1 : AR(1)과정의 적합 및 예측
# install.packages("portes") ; install.packages("lmtest")
library(glue)
library(astsa) # library for function acf2 & sarima.for
z = scan(glue(dataset_dir, "/eg8_7.txt"))
z = ts(z)
ts.plot(z, ylab = "z", main = "Simulated AR(1) Process")
acf2(z, max.lag = 24, main = "AR(1)과정의 ACF & PACF")
# sarima(z, 1,0,0)
sarima.for(z,25,1,0,0) # 그림 9-1 관측값과 예측값
