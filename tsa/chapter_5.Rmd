---
title: "시계열분석 5장"
output: html_document
date: "2025-06-12"

header-includes:
  - \newcommand{\bm}[1]{\boldsymbol{\mathbf{#1}}}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(glue)
list.files("../adv_reg/functions")
dir = getwd() ; mother_dir = dirname(dir)
dataset_dir = glue(dir, "/datasets", sep = "")
```

```{r}
reg_function_dir = glue(mother_dir, "/adv_reg/functions")
source(glue(reg_function_dir, "/mult_reg.R", sep = ""), echo = F)
source(glue(reg_function_dir, "/reg_diagnostics.R", sep = ""), echo = F)

tsa_function_dir = glue(mother_dir, "/tsa/functions")
source(glue(tsa_function_dir, "/exp_smt.R", sep = ""), echo = F)
```

## 5.1 정상 확률과정

```{r}
## Figure 5.1 : 정상 AR(1) 과정 phi = -0.7
library(astsa) # library for function arima.sim
set.seed(139672)

z = 17 + arima.sim(n = 102, list(ar = -0.7), rand.gen = rnorm)
ts.plot(z, ylab = "z", main = "그림 5-1 정상 AR(1) 과정 : phi = -0.7" ) ; abline(h = 17)
```

## 5.2 확률과정의 예

```{r}
## Figure 5.2 : 백색잡음과정
set.seed(1236)
a = rnorm(300, 0, 1)
ts.plot(ts(a), ylab = "random", main = "그림 5-2 백색잡음과정") ; abline(h = 0)
```

```{r}
## Figure 5.3 : 절편이 없는 Random Walk
z = arima.sim(n = 300, list(order = c(0, 1, 0)), rand.gen = rnorm)
ts.plot(z, ylab = "z", main = "그림 5-3 절편이 없는 Random Walk")
```

```{r}
## Figure 5.4 : 절편이 있는 Random Walk
set.seed(1246)
z = ts(cumsum(0.2 + rnorm(300, 0, 1)))
ts.plot(z, ylab = "z", main = "그림 5-4 절편이 있는 Random Walk")
```

## 5.3 자기상관함수

### 예제 5.1 표본자기상관계수(SACF)의 의미

```{r}
## Example 5.1
set.seed(139672)
z_vec = c(rep(0, 102))
error_t_vec = rnorm(102, 0, 1)
for (i in 1:100){
  error_t = error_t_vec[i]
  if (i == 1){
    Z_t = error_t
    z_vec[i] = Z_t
  }else{
    Z_t = 0.7*z_vec[i-1] + error_t
    z_vec[i] = Z_t
  }
}
z_vec = z_vec + 17
z_ts = ts(z_vec)
ts.plot(z_ts, ylab = "z", main = "정상 AR(1) 과정 : phi = -0.7") ; abline(h = 17)

acf(z_ts, main = "z_ts : AR(1) 과정의 ACF : phi = -0.7")
dev.new() # device for graphics
lag1.plot(z_ts,2) # 그림 5-6 & 5-7
```

```{r}
library(astsa)
set.seed(139672)
z = 17 + arima.sim(n = 102, list(ar = -0.7), rand.gen = rnorm)
ts.plot(z, ylab = "z", main = "정상 AR(1) 과정 : phi = -0.7" ) ; abline(h = 17)


# 1행 2열 레이아웃
par(mfrow=c(1,2))

acf(z, main="그림 5-5 AR(1) ACF : phi=-0.7")
lag.plot(z, lags=2, main="그림 5-6 & 5-7 Lag Plot")

# 레이아웃 원래대로 돌려놓기
par(mfrow=c(1,1))
```